{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-md-7">
    <div class="card shadow p-4 bg-white">
      <h2 class="mb-4 text-center" style="color:#6d28d9;">Edit Room</h2>

      <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <input name="title" class="form-control mb-3" value="{{ room.title }}" required>
        <textarea name="description" class="form-control mb-3" required>{{ room.description }}</textarea>
        <input type="number" name="price" class="form-control mb-3" value="{{ room.price }}" required>

        <select name="location" class="form-select mb-3" required>
          <option value="Kathmandu" {% if room.location|default_if_none:'' == "Kathmandu" %}selected{% endif %}>Kathmandu</option>
          <option value="Pokhara" {% if room.location|default_if_none:'' == "Pokhara" %}selected{% endif %}>Pokhara</option>
          <option value="Biratnagar" {% if room.location|default_if_none:'' == "Biratnagar" %}selected{% endif %}>Biratnagar</option>
        </select>

        <select name="room_type" class="form-select mb-3" required>
          <option value="Single" {% if room.room_type|default_if_none:'' == "Single" %}selected{% endif %}>Single</option>
          <option value="Double" {% if room.room_type|default_if_none:'' == "Double" %}selected{% endif %}>Double</option>
          <option value="Shared" {% if room.room_type|default_if_none:'' == "Shared" %}selected{% endif %}>Shared</option>
        </select>

        <input name="owner_name" class="form-control mb-3" value="{{ room.owner_name }}" required>
        <input name="contact_number" class="form-control mb-3" value="{{ room.contact_number }}" required>
        <input type="date" name="available_from" class="form-control mb-3" value="{{ room.available_from|date:'Y-m-d' }}" required>

        <h5 class="mt-3">Current Images</h5>
        <div class="d-flex flex-wrap gap-2 mb-3">
          {% for img in room.images.all %}
            <div class="position-relative">
              <img src="{{ img.image.url }}" width="120" class="rounded">
              <label class="form-check-label position-absolute top-0 start-0 bg-white p-1 rounded">
                <input type="checkbox" name="delete_images" value="{{ img.id }}"> Remove
              </label>
            </div>
          {% endfor %}
        </div>

        <h5 class="mt-3">Update / Add Images</h5>
        <input type="file" name="images" class="form-control mb-4" multiple>

        <button type="submit" class="btn btn-success w-100">Update</button>
      </form>
    </div>
  </div>
</div>
{% endblock %}
